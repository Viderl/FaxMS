@model IEnumerable<FaxMS.Models.Fax>
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@{
    ViewData["Title"] = "傳真紀錄查詢";
}
<h2>傳真紀錄查詢</h2>
<form method="get">
    <label>傳真號碼：<input type="text" name="faxNumber" value="@HttpContextAccessor.HttpContext.Request.Query["faxNumber"]" /></label>
    <label>傳真日期：<input type="date" name="date" value="@HttpContextAccessor.HttpContext.Request.Query["date"]" /></label>
    <button type="submit">查詢</button>
</form>
<table border="1" cellpadding="5">
    <tr>
        <th>傳真號碼</th>
        <th>傳真時間</th>
        <th>來源系統</th>
        <th>部門</th>
        <th>險種</th>
        <th>檔案</th>
        <th>查閱帳號</th>
        <th>查閱時間</th>
        <th>查閱IP</th>
    </tr>
@foreach (var item in Model)
{
    <tr>
        <td>@item.FaxNumber</td>
        <td>@item.ReceivedAt.ToString("yyyy-MM-dd HH:mm:ss")</td>
        <td>@item.SourceSystem</td>
        <td>@item.Department</td>
        <td>@item.InsuranceType</td>
        <td>
            @if (!string.IsNullOrEmpty(item.FilePath))
            {
                <a href="@Url.Content("~/download?path=" + item.FilePath)">PDF</a>
            }
        </td>
        <td>@item.ViewAccount</td>
        <td>@(item.ViewTime?.ToString("yyyy-MM-dd HH:mm:ss"))</td>
        <td>@item.ViewIp</td>
    </tr>
}
</table>